<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† - Ù…Ù†ØµØ© Ø§Ù„Ø­Ø±ÙÙŠÙŠÙ†</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="dashboard">
        <aside class="sidebar">
            <div class="logo">
                <h2>ğŸ› ï¸ Ù…Ù†ØµØ© Ø§Ù„Ø­Ø±ÙÙŠÙŠÙ†</h2>
            </div>
            <nav class="menu">
                <a href="dashboard.html" class="menu-item">
                    <span>ğŸ“Š</span> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                </a>
                <a href="categories.html" class="menu-item">
                    <span>ğŸ“</span> Ø§Ù„ÙØ¦Ø§Øª
                </a>
                <a href="materials.html" class="menu-item">
                    <span>ğŸ“¦</span> Ø§Ù„Ù…ÙˆØ§Ø¯
                </a>
                <a href="users.html" class="menu-item active">
                    <span>ğŸ‘¥</span> Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
                </a>
            </nav>
            <button class="logout-btn" onclick="logout()">
                <span>ğŸšª</span> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
            </button>
        </aside>

        <main class="main-content">
            <header class="header">
                <h1>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h1>
            </header>

            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Ø§Ù„Ø±Ù‚Ù…</th>
                            <th>Ø§Ù„Ø§Ø³Ù…</th>
                            <th>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</th>
                            <th>Ø§Ù„Ø¯ÙˆØ±</th>
                            <th>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„</th>
                        </tr>
                    </thead>
                    <tbody id="usersBody">
                        <tr>
                            <td colspan="5" style="text-align: center;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </main>
    </div>

    <script src="app.js"></script>
    <script>
        const API_URL = 'https://app-artisan.onrender.com/api';
        let users = [];

        async function loadUsers() {
            try {
                const token = localStorage.getItem('token');
                const response = await fetch(`${API_URL}/users`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                users = await response.json();
                renderUsers();
            } catch (error) {
                showError('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†');
            }
        }

        function renderUsers() {
            const tbody = document.getElementById('usersBody');
            
            if (users.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</td></tr>';
                return;
            }

            tbody.innerHTML = users.map((user, index) => `
                <tr>
                    <td>${index + 1}</td>
                    <td>${user.name}</td>
                    <td>${user.email}</td>
                    <td>${getRoleText(user.role)}</td>
                    <td>${formatDate(user.created_at)}</td>
                </tr>
            `).join('');
        }

        function getRoleText(role) {
            const roles = {
                'admin': 'Ù…Ø¯ÙŠØ±',
                'artisan': 'Ø­Ø±ÙÙŠ',
                'client': 'Ø¹Ù…ÙŠÙ„'
            };
            return roles[role] || role;
        }

        function formatDate(dateString) {
            if (!dateString) return '-';
            const date = new Date(dateString);
            return date.toLocaleDateString('ar-SA');
        }

        loadUsers();
    </script>
</body>
</html>
